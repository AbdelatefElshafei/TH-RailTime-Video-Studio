<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TH Railtime Video Studio</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        
        :root {
            --bg-primary: #0f0f23;
            --bg-secondary: #1a1a2e;
            --bg-tertiary: #16213e;
            --accent-blue: #00d4ff;
            --accent-purple: #6366f1;
            --accent-green: #10b981;
            --text-primary: #f8fafc;
            --text-secondary: #cbd5e1;
            --border-color: #334155;
        }

        body {
            background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
        }

        
        .clip { 
            position: absolute; 
            height: 85%; 
            top: 7.5%; 
            border-radius: 8px; 
            overflow: hidden; 
            white-space: nowrap; 
            padding: 8px 12px; 
            font-size: 11px; 
            font-weight: 500;
            cursor: move; 
            box-shadow: 0 4px 12px rgba(0,0,0,0.3), 0 2px 4px rgba(0,0,0,0.2); 
            user-select: none;
            backdrop-filter: blur(8px);
            border: 1px solid rgba(255,255,255,0.1);
            transition: all 0.2s ease;
        }

        .clip:hover {
            transform: translateY(-1px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.4), 0 4px 8px rgba(0,0,0,0.3);
        }

        .clip.selected { 
            border: 2px solid var(--accent-blue); 
            z-index: 10;
            box-shadow: 0 0 20px rgba(0, 212, 255, 0.3), 0 6px 20px rgba(0,0,0,0.4);
        }

        .video-clip { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white; 
        }

        .audio-clip { 
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white; 
        }

        .text-clip { 
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            color: white; 
        }

        .resize-handle { 
            position: absolute; 
            top: 0; 
            bottom: 0; 
            width: 8px; 
            cursor: ew-resize; 
            z-index: 11;
            background: rgba(255,255,255,0.1);
            opacity: 0;
            transition: opacity 0.2s ease;
        }

        .clip:hover .resize-handle {
            opacity: 1;
        }

        .resize-handle.left { left: 0; border-radius: 8px 0 0 8px; }
        .resize-handle.right { right: 0; border-radius: 0 8px 8px 0; }

        #playhead { 
            position: absolute; 
            top: 0; 
            bottom: 0; 
            width: 3px; 
            background: linear-gradient(180deg, var(--accent-blue) 0%, #0ea5e9 100%);
            z-index: 20; 
            pointer-events: none;
            border-radius: 1.5px;
            box-shadow: 0 0 10px rgba(0, 212, 255, 0.5);
        }

        #interactive-overlay { 
            position: absolute; 
            top: 0; 
            left: 0; 
            right: 0; 
            bottom: 0; 
            cursor: grab; 
        }

        #selection-box { 
            position: absolute; 
            border: 2px solid var(--accent-blue); 
            pointer-events: none;
            background: rgba(0, 212, 255, 0.1);
            border-radius: 4px;
        }

        .selection-handle { 
            position: absolute; 
            width: 12px; 
            height: 12px; 
            background: var(--accent-blue);
            border: 2px solid white; 
            border-radius: 50%; 
            pointer-events: all;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
        }

        .selection-handle.nw { top: -6px; left: -6px; cursor: nwse-resize; }
        .selection-handle.ne { top: -6px; right: -6px; cursor: nesw-resize; }
        .selection-handle.sw { bottom: -6px; left: -6px; cursor: nesw-resize; }
        .selection-handle.se { bottom: -6px; right: -6px; cursor: nwse-resize; }

        
        .modern-button {
            background: linear-gradient(135deg, var(--accent-purple) 0%, #4f46e5 100%);
            border: none;
            border-radius: 8px;
            padding: 8px 16px;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.2s ease;
            box-shadow: 0 2px 8px rgba(99, 102, 241, 0.3);
        }

        .modern-button:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 16px rgba(99, 102, 241, 0.4);
        }

        .modern-button:active {
            transform: translateY(0);
        }

        .modern-button.secondary {
            background: linear-gradient(135deg, var(--bg-tertiary) 0%, #1e293b 100%);
            border: 1px solid var(--border-color);
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        .modern-button.danger {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            box-shadow: 0 2px 8px rgba(239, 68, 68, 0.3);
        }

        .modern-button.success {
            background: linear-gradient(135deg, var(--accent-green) 0%, #059669 100%);
            box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);
        }

        
        .glass {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        
        .modern-card {
            background: var(--bg-tertiary);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid var(--border-color);
            box-shadow: 0 4px 24px rgba(0,0,0,0.2);
        }

        
        #timeline-container {
            background: linear-gradient(180deg, var(--bg-secondary) 0%, var(--bg-tertiary) 100%);
            border-top: 1px solid var(--border-color);
            border-radius: 12px 12px 0 0;
        }

        
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-primary);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, var(--accent-purple), var(--accent-blue));
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #4f46e5, #0ea5e9);
        }

        
        .media-item {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 12px;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .media-item:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: var(--accent-blue);
            transform: translateY(-1px);
        }

        
        .property-group {
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 12px;
        }

        .property-label {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 6px;
        }

        .property-input {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 8px 12px;
            color: var(--text-primary);
            width: 100%;
            transition: all 0.2s ease;
        }

        .property-input:focus {
            outline: none;
            border-color: var(--accent-blue);
            box-shadow: 0 0 0 3px rgba(0, 212, 255, 0.1);
        }

        
        header {
            background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
            backdrop-filter: blur(16px);
            border-bottom: 1px solid var(--border-color);
        }

        
        @keyframes pulse-glow {
            0%, 100% { box-shadow: 0 0 10px rgba(0, 212, 255, 0.3); }
            50% { box-shadow: 0 0 20px rgba(0, 212, 255, 0.6); }
        }

        .recording {
            animation: pulse-glow 2s infinite;
        }

        
        .control-panel {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-tertiary) 100%);
            border-top: 1px solid var(--border-color);
        }

        
        #time-display {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 6px 12px;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            color: var(--accent-blue);
        }
    </style>
</head>
<body class="text-white font-sans flex flex-col h-screen" style="background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);">

    <header class="flex justify-between items-center p-4 shadow-2xl z-20" style="background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%); backdrop-filter: blur(16px); border-bottom: 1px solid var(--border-color);">
        <div class="flex items-center space-x-3">
            <div class="w-8 h-8 rounded-lg bg-gradient-to-br from-blue-400 to-purple-600 flex items-center justify-center">
                <img src="Logo.png" alt="Logo" class="w-full h-full object-contain">
            </div>
            <h1 class="text-2xl font-bold bg-gradient-to-r from-blue-400 to-purple-600 bg-clip-text text-transparent">TH Railtime Video Studio</h1>
        </div>
        <button id="export-button" class="modern-button success">
            <svg class="w-4 h-4 inline-block mr-2" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd"/>
            </svg>
            Export Video
        </button>
    </header>

    <div class="flex flex-grow overflow-hidden">
        <aside class="w-1/4 p-6 flex flex-col" style="background: linear-gradient(180deg, var(--bg-secondary) 0%, var(--bg-tertiary) 100%);">
            <div id="media-bin-container" class="mb-6">
                <div class="flex items-center space-x-2 mb-4">
                    <svg class="w-5 h-5 text-blue-400" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M3 4a1 1 0 011-1h4a1 1 0 010 2H6.414l2.293 2.293a1 1 0 01-1.414 1.414L5 6.414V8a1 1 0 01-2 0V4zm9 1a1 1 0 010-2h4a1 1 0 011 1v4a1 1 0 01-2 0V6.414l-2.293 2.293a1 1 0 11-1.414-1.414L13.586 5H12zm-9 7a1 1 0 012 0v1.586l2.293-2.293a1 1 0 111.414 1.414L6.414 15H8a1 1 0 010 2H4a1 1 0 01-1-1v-4zm13-1a1 1 0 011 1v4a1 1 0 01-1 1h-4a1 1 0 010-2h1.586l-2.293-2.293a1 1 0 111.414-1.414L15.586 13V12a1 1 0 011-1z" clip-rule="evenodd"/>
                    </svg>
                    <h2 class="text-lg font-bold text-white">Media Bin</h2>
                </div>
                <div id="media-bin" class="h-64 glass rounded-xl p-4 overflow-y-auto space-y-3 border"></div>
                <input type="file" id="file-input" class="hidden" multiple />
                <button id="import-button" class="mt-4 w-full modern-button secondary">
                    <svg class="w-4 h-4 inline-block mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM6.293 6.707a1 1 0 010-1.414l3-3a1 1 0 011.414 0l3 3a1 1 0 01-1.414 1.414L11 5.414V13a1 1 0 11-2 0V5.414L7.707 6.707a1 1 0 01-1.414 0z" clip-rule="evenodd"/>
                    </svg>
                    Import Media
                </button>
            </div>
            
            <div id="properties-panel" class="flex-grow hidden overflow-y-auto">
                <div class="flex items-center space-x-2 mb-4">
                    <svg class="w-5 h-5 text-purple-400" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd"/>
                    </svg>
                    <h2 class="text-lg font-bold text-white">Properties</h2>
                </div>
                <div id="properties-content" class="modern-card space-y-4 mb-4"></div>
                <button id="delete-clip-button" class="w-full modern-button danger">
                    <svg class="w-4 h-4 inline-block mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"/>
                    </svg>
                    Delete Clip
                </button>
            </div>
        </aside>

        <main class="w-3/4 flex flex-col">
            <div id="preview-window" class="flex-grow flex items-center justify-center relative overflow-hidden" style="background: radial-gradient(ellipse at center, #1a1a2e 0%, #0f0f23 100%);">
                <div class="absolute inset-0 opacity-5">
                    <div class="absolute inset-0" style="background-image: radial-gradient(circle at 25% 25%, rgba(99, 102, 241, 0.3) 0%, transparent 50%), radial-gradient(circle at 75% 75%, rgba(0, 212, 255, 0.3) 0%, transparent 50%);"></div>
                </div>
                
                <div id="preview-content" class="relative rounded-xl overflow-hidden shadow-2xl" style="aspect-ratio: 16/9; max-width: 90%; max-height: 90%;">
                    <img id="preview-image" class="max-w-full max-h-full block rounded-xl">
                    <video id="preview-video" class="max-w-full max-h-full block hidden rounded-xl"></video>
                    <div id="interactive-overlay" class="hidden rounded-xl">
                        <div id="selection-box">
                            <div class="selection-handle nw"></div><div class="selection-handle ne"></div>
                            <div class="selection-handle sw"></div><div class="selection-handle se"></div>
                        </div>
                    </div>
                </div>
                
                <div id="status-overlay" class="hidden absolute inset-0 glass flex-col items-center justify-center p-8 text-center z-30 rounded-xl m-4">
                    <div class="w-16 h-16 rounded-full bg-gradient-to-br from-blue-400 to-purple-600 flex items-center justify-center mb-6">
                        <svg class="w-8 h-8 text-white" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm3 2h6v4H7V5zm8 8v2h1v-2h-1zm-2-2H7v4h6v-4z" clip-rule="evenodd"/>
                        </svg>
                    </div>
                    <h3 id="status-message" class="text-2xl font-bold mb-6"></h3>
                    <div class="w-full max-w-md">
                        <div class="bg-gray-700 rounded-full h-3 overflow-hidden">
                            <div id="status-progress" class="bg-gradient-to-r from-blue-400 to-purple-600 h-3 rounded-full transition-all duration-300" style="width: 0%"></div>
                        </div>
                    </div>
                    <a id="download-link" href="#" class="hidden mt-8 modern-button success">
                        <svg class="w-4 h-4 inline-block mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd"/>
                        </svg>
                        Download Video
                    </a>
                </div>
            </div>

            <div class="flex-shrink-0 control-panel p-4 flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <div class="flex items-center space-x-3">
                        <button id="play-pause-button" class="modern-button secondary w-20 flex items-center justify-center">
                            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" clip-rule="evenodd"/>
                            </svg>
                            <span class="ml-2">Play</span>
                        </button>
                        <button id="stop-button" class="modern-button secondary">
                            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8 7a1 1 0 00-1 1v4a1 1 0 001 1h4a1 1 0 001-1V8a1 1 0 00-1-1H8z" clip-rule="evenodd"/>
                            </svg>
                        </button>
                        <div id="time-display" class="text-sm font-mono">00:00.0</div>
                    </div>
                </div>
                
                <div class="flex items-center space-x-3">
                    <div class="text-sm font-semibold text-gray-300 flex items-center">
                        <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03zM12.12 15.12A3 3 0 017 13s.879.5 2.5.5c0-1 .5-4 1.25-4.5.5 1 .786 1.293 1.371 1.879A2.99 2.99 0 0113 13a2.99 2.99 0 01-.879 2.121z" clip-rule="evenodd"/>
                        </svg>
                        Tools
                    </div>
                    <button id="add-video-track-button" class="modern-button secondary text-xs">
                        <svg class="w-3 h-3 inline-block mr-1" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M2 6a2 2 0 012-2h6l2 2h6a2 2 0 012 2v6a2 2 0 01-2 2H4a2 2 0 01-2-2V6z"/>
                        </svg>
                        Video Track
                    </button>
                    <button id="add-audio-track-button" class="modern-button secondary text-xs">
                        <svg class="w-3 h-3 inline-block mr-1" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.707.707L4.586 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.586l3.707-3.707a1 1 0 011.09-.217zM15.657 6.343a1 1 0 011.414 0A9.972 9.972 0 0119 12a9.972 9.972 0 01-1.929 5.657 1 1 0 11-1.414-1.414A7.971 7.971 0 0017 12c0-2.21-.894-4.208-2.343-5.657a1 1 0 010-1.414zm-2.829 2.828a1 1 0 011.415 0A5.983 5.983 0 0115 12a5.984 5.984 0 01-.757 2.828 1 1 0 11-1.415-1.414A3.987 3.987 0 0013 12a3.988 3.988 0 00-.172-1.414 1 1 0 010-1.415z" clip-rule="evenodd"/>
                        </svg>
                        Audio Track
                    </button>
                    <button id="add-text-clip-button" class="modern-button secondary text-xs">
                        <svg class="w-3 h-3 inline-block mr-1" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 5v8a2 2 0 01-2 2h-5l-5 4v-4H4a2 2 0 01-2-2V5a2 2 0 012-2h12a2 2 0 012 2zM7 8H5v2h2V8zm2 0h2v2H9V8zm6 0h-2v2h2V8z" clip-rule="evenodd"/>
                        </svg>
                        Text Clip
                    </button>
                </div>
            </div>
            
            <div id="timeline-container" class="h-64 border-t-2 p-4 space-y-3 overflow-auto relative rounded-t-xl" style="background: linear-gradient(180deg, var(--bg-secondary) 0%, var(--bg-tertiary) 100%); border-top: 1px solid var(--border-color);">
                <div id="playhead"></div>
            </div>
        </main>
    </div>
    
    <script src="/client.js"></script>
</body>
</html>